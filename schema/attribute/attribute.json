{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "attribute_core",
  "description" : "Validate core structure of an attribute.",
  "required": ["_nid", "uuid", "att_type", "value"],
  "properties": {
    "_nid": { "type": "integer", "minimum" : 1, "maximum" : 9223372036854775806 },
    "uuid": { "type": "string", "pattern" : "^attribute--[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[89abAB][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$" },
	"_obj_ref" : {
	  "type" : "array",
	  "items" : {  "type": "integer"}
	},
	"_raw_ref" : {
	  "type" : "array",
	  "items" : {  "type": "integer"}
	},
	"_valid": {"type": "boolean"},
	"att_type": { "enum" : ["asn", "btc", "comment", "domain", "filename", "hash", "hostname", "ipv4", "ipv6", "md5", "network", "port", "sha1", "sha224", "sha256", "time", "timeiso", "timestamp", "timezone", "uri", "url"]},
	"value": {"oneOf" : [{"type": "integer"}, {"type": "string"}]}
  },
  "additionalProperties": false,
  
  "allOf" : [
  
  {"if":{"properties":{"att_type":{"const":     "asn"    }}}, "then": {"properties": { "value": { "type": "integer", "minimum": 1, "maximum": 65535 }}}},
  
  {"if":{"properties":{"att_type":{"const":     "btc"    }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$" }}}},
  
  {"if":{"properties":{"att_type":{"const":   "comment"  }}}, "then": {"properties": { "value": { "type": "string", "maxLength": 1000 }}}},
  
  {"if":{"properties":{"att_type":{"const":   "domain"   }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^(?!:\/\/)([a-zA-Z0-9-_]+\\.)*[a-zA-Z0-9][a-zA-Z0-9-_]+\\.[a-zA-Z]{2,11}?$" }}}},
  
  {"if":{"properties":{"att_type":{"const":  "filename"  }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^[\\w\\-. ]+$" }}}},
   
  {"if":{"properties":{"att_type":{"const":    "hash"    }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^[a-fA-F0-9]+$" }}}},
  
  {"if":{"properties":{"att_type":{"const":  "hostname"  }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$" }}}},
  
  {"if":{"properties":{"att_type":{"const":    "ipv4"    }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$" }}}},
  
  {"if":{"properties":{"att_type":{"const":    "ipv6"    }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$" }}}},
  
  {"if":{"properties":{"att_type":{"const":     "md5"    }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^[a-fA-F\\d]{32}$" }}}},
  
  {"if":{"properties":{"att_type":{"const":   "network"  }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/(3[0-2]|[1-2][0-9]|[0-9]))$" }}}},
  
  {"if":{"properties":{"att_type":{"const":    "port"    }}}, "then": {"properties": { "value": { "type": "integer", "minimum": 1, "maximum": 65535 }}}},
  
  {"if":{"properties":{"att_type":{"const":    "sha1"    }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^[0-9A-Fa-f]{5,40}$" }}}},
  
  {"if":{"properties":{"att_type":{"const":   "sha256"   }}}, "then": {"properties": { "value": { "type": "string", "pattern": "^[A-Fa-f0-9]{64}$" }}}},
  
  {"if":{"properties":{"att_type":{"const":  "timestamp" }}}, "then": {"properties": { "value": { "type": "number", "minimum": 0}}}},

  {"if":{"properties":{"att_type":{"const":     "url"    }}}, "then": {"properties": { "value": { "type": "string"}}}}

  
  ]
}
