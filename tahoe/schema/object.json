{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "object_core",
  "description" : "Validate core structure of an object.",
  "required": ["itype", "uuid", "obj_type", "attributes"],
  "properties": {
    "itype": {"const" : "object"},
    "uuid": { "type": "string", "pattern" : "^object--[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[89abAB][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$" },
	"obj_type": { "enum" : ["attachment", "attacker", "autonomous_system", "bank_ac", "btc", "campaign", "command_success", "comment", "comp_algo_set", "data", "datetime", "dns", "domain", "dst", "dst_port", "duration", "email_attachment", "encr_algo_set", "end_time", "file", "geoip", "github", "hash", "host", "id", "identity", "ids_config", "info", "kex_algo_set", "login_credential", "login_success", "mac_algo_set", "malware", "mutex", "network", "organization", "other", "pattern_in_file", "pattern_in_memory", "pdb", "port", "protocol", "pub_key_algo_set", "registry", "session_identifier", "shell_command", "size", "src", "src_port", "ssh", "ssh_client_env", "ssh_client_size", "ssh_version", "success", "target", "test", "text", "threat_actor", "threat_level", "time", "uri", "url", "user_agent", "uuid", "vulnerability", "whois", "windows_scheduled_task", "windows_service", "x509", "x_misp_named_pipe","x_misp_org", "x_misp_orgc", "x_misp_sigma"]},
	"attributes": { "type" : "array"},
	"_ref" : { "type" : "array", "items" : { "type": "string", "pattern" : "^(attribute|event|session|raw)--[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[89abAB][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$"} }
  },
  "additionalProperties": false
}
